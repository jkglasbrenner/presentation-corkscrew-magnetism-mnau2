---
title: "The corkscrew magnetism of MnAu<sub>2</sub>"
subtitle: "Intersecting data science and materials simulations<div style='float:left'></div><hr color='#EB811B' size=1px width=796px>"
author: "James K. Glasbrenner"
date: "June 28, 2019"
output: xaringan::moon_reader
---

# Meet manganese auride

.grid[
.pull-left-60.flex[
.valign[
- Single crystal structure is tetragonal and layered

- A metal that is a permanent magnet at room temperature

- Magnetic order forms a corkscrew-like spiral structure

- The spiral angle can be controlled in several ways
]
]
	
.pull-right-40.flex[
.valign[
```{r mnau2-crystal-structure, echo = FALSE, out.width = "90%", fig.align=NA}
knitr::include_graphics("img/mnau2_crystal_structure.png")
```
]
.valign[
```{r mnau2-magnetic-structure, echo = FALSE, out.width = "75%", fig.align=NA}
knitr::include_graphics("img/mnau2_magnetic_structure.png")
```
]
]
]

???

The material manganese auride has been a subject of study for over 60 years owing to its intriguing properties. To get ourselves acquianted with the material, let's review some basic facts about it. The material, when it is synthesized as a single crystal, has a tetragonal, layered structure as shown in the schematic on the right. This crystal structure is assumed to periodically repeat itself in all directions. The material is a metal that is a permanent magnet at room temperature. The magnetic order forms a corkscrew-like spiral structure within the layers of manganese, which is shown in this figure on the far right. The vectors attached to the manganese sites represent the magnetic ordering, and this shows what a spiral with a 45 degree turn angle would look like. What is interesting about this spiral structure is that it can be controlled in several different ways.

---

# Meet manganese auride

.grid[
.pull-left-60.flex[
.valign[
- **Temperature:** magnetic order disappears above 363 degrees Kelvin (194 $^{\circ}$F)

- **Magnetic fields:** spiral unravels to ferromagnetic order at 10 kilo-oersted (MRI device)

- **Pressure:** spiral unravels to ferromagnetic order at 10 kilobars of pressure (10 times the pressure at the bottom of the Mariana Trench)

.content-box-gray[
- **Potential logic device:** changing the spiral angle also changes the material's electrical resistance
]
]
]
	
.pull-right-40.flex[
.valign[
```{r mnau2-crystal-structure, echo = FALSE, out.width = "90%", fig.align=NA}
```
]
.valign[
```{r mnau2-magnetic-structure, echo = FALSE, out.width = "75%", fig.align=NA}
```
]
]
]

???

One way to affect the spiral structure is to change the temperature. For any given permanent magnet, there is a critical temperature above which magnetic ordering disappears. For manganese auride, that temperature is 363 degrees Kelvin, which is approximately 194 degrees Fahrenheit. Another way to impact the spiral structure is to apply an external magnetic field. If you apply a magnetic field with a magnitude of about 10 kilo-oersted, which is a field that can be easily generated by an MRI machine, the spiral will unravel and all these vectors will point in the same direction, yielding a ferromagnet. You can achieve a similar effect by applying pressure to the material instead of an external magnetic field. This will also unravel the spiral to ferromagnetic order, and this transition occurs at about 10 kilobars of pressure, which is roughly 10 times the pressure felt at the bottom of the Mariana Trench. Having all these different ways to manipulate the spiral is interesting from an applications point of view because these structural changes to the spiral can be detected as changes in electrical resistance. This means that there is potential to use manganese auride, or materials similar to it, for building a logic device. However, before we can meaningfully proceed with making a logic device, we need to have a good model for it to understand its behavior under different kinds of conditions.

---

# How to study this?

.grid[
.grid-valign[
.content-box-red[
**Derive a mathematical model**
]
.content-box-green[
**Gather/generate data**
]
.content-box-yellow[
**Model training**
]
]
]

???

How should we go about studying this material so that we can build such a model? Here we can actually follow a workflow that overlaps with some of the stages of a data science workflow. The three main stages of our workflow are to derive a mathematical model, gather or generate data, and then train and evaluate the model. Let's step through the details of each of these three stages.

---

# Derive a mathematical model

.grid[
.content-box-red.grid-valign[
**Derive a mathematical model**

- Energy-based model for magnetic interactions

- Physically meaningful model parameters
]
]

???

To derive a mathematical model for the magnetic interactions that give rise to the spiral structure, we will employ an energy-based model. Energy-based models are common to physics and result in models that have physically meaningful parameters. These parameters are useful for understanding the causal mechanisms responsible for observed behavior.

---

# Classical Heisenberg Model

.pull-left[
```{r heisenberg-model-afm-checkerboard, echo = FALSE, out.width = "85%"}
knitr::include_graphics("img/heisenberg_model_afm_checkerboard.png")
```
]

.pull-right[
<div style="margin-bottom: 10%;"></div>
.content-box-gray.center[Model quantifies the _nature_ and _strength_ of magnetic interactions]

$$H=\dfrac{1}{2}\sum_{ij}J_{ij}\hat{m}_{i}\cdot\hat{m}_{j}$$

- _J_ > 0: parallel alignment preferred

- _J_ < 0: anti-parallel alignment preferred
]

```{r github-neighbormodels, echo = FALSE, out.width = "75%"}
knitr::include_graphics("img/github_neighbormodels.png")
```

???

The energy-based model that we will use for the magnetic interactions in manganese auride is known as the classical Heisenberg model. The Heisenberg model allows us to quantify both the nature and strength of magnetic interactions and its general form is given in the formula below. It models magnetism as a series of magnetic vectors situated on a lattice like what is shown on the left. This illustration shows the so-called checkerboard magnetic pattern. In the Heisenberg model, magnetic interactions are pairwise and modeled as dot products that are scaled by a parameter J. The J parameter is distance dependent, so there is J1 for first neighbors, J2 for second neighbors, and so on. The sign of the J parameters tells us what kinds of magnetic patterns are energetically preferred. If the J parameter is positive, then this means that the pair of magnetic vectors prefer to be aligned in parallel. Conversely, if the J parameter is negative then they prefer to be antiparallel. These dot products are then summed over all site pairs on the lattice. Although theoretically this is an infinite sum, in practice a neighbor cutoff needs to be determined, which is a question we will return to in a little bit. Also, as a side note, the book-keeping aspect of counting neighbors and taking dot products over different magnetic patterns is tedious and error prone, particularly if you want to consider complex magnetic patterns. It is for this reason that I developed a Python package called neighbormodels that automates this procedure, which I've made available on GitHub and PyPI for install.

---

# 1D magnetic spiral model

```{r heisenberg-1d-spiral, echo = FALSE, out.width = "80%"}
knitr::include_graphics("img/heisenberg_1d_spiral.svg")
```

- The magnetic vectors for manganese auride all sit in-plane and the planes are parallel (known from experiment)

- The relative angle between any two neighboring magnetic vectors is always $\varphi$, the relative angle between second-nearest neighbors is $2\varphi$, and so on

- Heisenberg model reduces to the following simplified form,

  $$E(\varphi)=\dfrac{1}{2}\sum_{n}J_{n}\cos\left(n\varphi\right)$$
  
???

It's known from experiment that the magnetic vectors of manganese auride all sit in-plane and that each of these planes are parallel to one another. The turn angle for the spiral is also consistent throughout the material, with the relative angle between two neighboring vectors equaling phi. This schematic illustrates the general idea of what this system looks like. We can see then that the relative angle between second-nearest neighbors is two-phi, and so on. When we apply these constraints to the general Heisenberg model formula, we find that it simplifies to the form given at the bottom. Our model reduces to a sum of cosines.

---

# Gather/generate data

.grid[
.content-box-green.grid-valign[
**Gather/generate data**

- First-principles electronic structure calculations based on quantum mechanics (density functional theory)

- Serves as a virtual laboratory for investigating a material's electrical, magnetic, structural, and transport properties

- Calculate realistic and accurate energies for different magnetic patterns at different pressures
]
]

???

Now that we have a plausible energy model, we need to gather data to validate whether or not it reasonably captures the system's behavior. To do this, we employ the use of first-principles electronic structure calculations based on the laws of quantum mechanics. The specific method I used is known as density functional theory. First-principles calculations serve as a virtual laboratory for investigating a material's electrical, magnetic, structural, and transport properties. It enables us to calculate realistic and accurate energies for different magnetic patterns at different pressures, which in turn can be used as training data for our model.

---

# Electronic structure overview

```{r two-atoms-unbonded, echo = FALSE, out.width = "100%"}
knitr::include_graphics("img/two_atoms_unbonded.svg")
```

.center[Energy spectra of 2 simple atoms, no bonding]

???

Although I won't go into the details of what density functional theory is, I do want to take a couple of moments to give you a general overview of what I mean by the phrase electronic structure. It helps to consider a simple conceptual example to demonstrate what it is and how it looks in materials. Imagine that we have two isolated atoms. You might recall from a chemistry or physics course that the electrons that orbit an atom occupy orbitals that correspond to a series of discrete energy levels. Here we just look at one energy level per atom, which is represented by the black lines on the two sides of the slide. When far apart, there is no bonding behavior between the atoms and the energy levels remain like this. 

---

# Electronic structure overview

```{r two-atoms-bonded, echo = FALSE, out.width = "100%"}
knitr::include_graphics("img/two_atoms_bonded.svg")
```

.center[Energy spectra of 2 bonded atoms]

???

When you bring the atoms closer together and let them bond, they form bonding and anti-bonding energy levels. This results in energy levels that are shifted relative to where we started. Also note that, for a fixed number of atoms, the number of energy levels has been preserved.

---

# Electronic structure overview

```{r four-atoms-bonded, echo = FALSE, out.width = "100%"}
knitr::include_graphics("img/four_atoms_bonded.svg")
```

.center[Energy spectra of 4 bonded atoms]

???

Now, imagine that we bring in two more atoms into the system, which also participate in the bonding. This will double the number of energy levels in our spectrum like shown here. 

---

# Electronic structure overview

```{r eight-atoms-bonded, echo = FALSE, out.width = "100%"}
knitr::include_graphics("img/eight_atoms_bonded.svg")
```

.center[Energy spectra of 8 bonded atoms]

???

Again, we can then double our number of atoms again, giving us eight bonded atoms. You can start to see that some of the energy levels may end up close to one another.

---

# Electronic structure overview

```{r many-atoms-bonded, echo = FALSE, out.width = "100%"}
knitr::include_graphics("img/many_atoms_bonded.svg")
```

.center[Energy spectra of many bonded atoms]

???

If you take this process to the logical extreme, where the number of atoms becomes very large, you end up with continuous bands of energy levels. This is what the electronic structure looks like in a material. 

---

# Electronic structure overview

.pull-left[
* Electrons fill the energy bands much like water fills a drinking glass

* The _Fermi energy_ is where the energy filling process maxes out

* Many important materials properties depend on the location of the Fermi energy
]

.pull-right[
```{r band-schematic, echo = FALSE, out.width = "100%"}
knitr::include_graphics("img/bands_schematic.svg")
```
]

.content-box-gray[
- **Metal:** The Fermi energy lies within an energy band
- **Insulator/semiconductor:** The Fermi energy sits at the top of an energy band
]

.content-box-green.center[The topology of the _band structure_ depends on a material's structural and chemical details.]

???

After we've built up this spectrum of energy bands, we need to bring the electrons into the system. The electrons will fill the energy bands much like water fills up a drinking glass. This is what is shown in the diagram on the right. After all the electrons have been added in, we will see where the energy maxes out. This maximum energy level is called the Fermi energy, and many important materials properties depend on the location of the Fermi energy. For example, materials can be classified into one of two groups based on this. If the Fermi level lies somewhere within an energy band, then the material is a metal. If instead it lies at the very top of one band, right where one of these gaps begin, then the material is instead an insulator or a semiconductor. The distinction between insulator and semiconductor depends on how large this energy gap is. The particular topology of the band structure depends on a material's structural and chemical details. This is the information that first-principles calculations give us access to, making it a powerful tool for studying materials properties and phenomena.

---

# .font80[First-principles structural relaxation]

- **Optimization problem:** constrain the volume of our material, then move the atoms around until the energy is minimized

- **Data output:** energy as a function of volume

- **Birch-Murnaghan equation of state model:** mapping between volume and pressure

```{r mnau2-eos, echo = FALSE, out.width = "75%"}
knitr::include_graphics("img/mnau2_equation_of_state.svg")
```

---

# .font80[First-principles magnetic energies]

### Workflow

1. **Vary parameters:** pressure, adding/subtracting charge

2. **Calculate energies:** standard set of spiral angles

3. **Data preprocessing:** extract and clean data from output files and save to disk

<div style="margin-bottom: 10%;"></div>

.content-box-gray[
- 1,572 calculations to run on a high-performance computing cluster

- 64 to 128 cores and 1â€“2 hours runtime per calculation
]

---

# .font80[First-principles magnetic energies]

```{r mnau2-spiral-energies, echo = FALSE, out.width = "100%"}
knitr::include_graphics("img/mnau2_spiral_energies.svg")
```

---

# Model training

.grid[
.content-box-yellow.grid-valign[
**Model training**

- Train model using regression techniques

- Cross-validation

- Model/feature selection
]
]

---

# Model training methods

```{r scikit-learn-frontpage, echo = FALSE, out.width = "90%"}
knitr::include_graphics("img/scikit-learn-frontpage.png")
```

- **Model features:** derived from 1D Heisenberg model, consider cutoffs of up to 5 neighbors

- **Regression:** ordinary least squares (ridge regression also checked)

- **Cross-validation technique:** repeated k-fold (10 folds, 20 repeats), score using mean-squared error

- **Model selection approach:** select the neighbor cutoff where improvements in mean-squared error become marginal

---

# Cross-validation results

```{r mnau2-heisenberg-1d-crossval-mse, echo = FALSE, out.width = "80%"}
knitr::include_graphics("img/mnau2_heisenberg_1d_crossval_mse.svg")
```

---

# Selected model performance

```{r mnau2-heisenberg-1d-obsv-vs-pred, echo = FALSE, out.width = "80%"}
knitr::include_graphics("img/mnau2_heisenberg_1d_obsv_vs_pred.svg")
```

---

# .font80[Fitted parameters vs pressure]

```{r mnau2-exchange-vs-pressure, echo = FALSE, out.width = "80%"}
knitr::include_graphics("img/mnau2_exchange_vs_pressure.svg")
```

---

# .font80[Spiral angle vs pressure]

```{r mnau2-angle-vs-pressure, echo = FALSE, out.width = "80%"}
knitr::include_graphics("img/mnau2_angle_vs_pressure.svg")
```

---

# .font60[Build spiral model using _collinear_ calculations]

.content-box-red.center[
**Recent and ongoing work**
]

<div style="margin-bottom: 7%;"></div>

- Noncollinear magnetic order is typically **not** well-behaved like manganese auride

- First-principles computational discovery of noncollinear magnetic order is difficult

- Computing and analyzing the magnetic energy landscape from a trained model is far easier

- Train Heisenberg model on magnetic energies for collinear magnetic patterns, then use it to detect noncollinear order

- Use manganese auride to prototype this idea

---

# Preliminary results

```{r mnau2-col-only-obsv-vs-pred, echo = FALSE, out.width = "60%"}
knitr::include_graphics("img/mnau2_col_only_obsv_vs_pred.svg")
```

| method       | J<sub>1</sub> | J<sub>2</sub> | J<sub>3</sub> | J<sub>4</sub> | $\varphi$ |
| ------       | -------       | -------       | -------       | -------       | -------   |
| collinear    | -6.419532     | 2.911147      | -0.174256     | -0.259623     | 63.5      |
| noncollinear | -6.703701     | 3.287076      | -0.31799      | -0.235331     | 65.9      |

---

# Where to go from here

.grid[
.pull-up[
.content-box-green[
**What's done**

- Numerical study of the phase diagram of 1D spiral model
- Is the pressure-induced unraveling of the spiral angle to ferromagnetic order continuous or discontinous?
]
]

.pull-lower-left[
```{r mnau2-phase-transition-diagram, echo = FALSE, out.width="56%"}
knitr::include_graphics("img/mnau2_phase_transition_diagram.png")
```
]

.pull-lower-right[
```{r mnau2-phase-diagram, echo = FALSE, out.width="65%"}
knitr::include_graphics("img/mnau2_phase_diagram.gif")
```
]
]

---

# Where to go from here

.grid[
.pull-up[
.content-box-yellow[
**Ongoing work**

- Extend model parameters to explicitly depend on pressure
- Numerical finite temperature studies using Markov-Chain Monte Carlo simulations
- Automating the computational discovery of noncollinear magnetic order
]
]

.pull-down[
```{r github-spyns, echo = FALSE, out.width = "100%"}
knitr::include_graphics("img/github_spyns.png")
```
]
]

---

class: clear, center, middle

# .black[Questions?]

<div style='float:left'></div><hr color='#EB811B' size=1px width=796px>
